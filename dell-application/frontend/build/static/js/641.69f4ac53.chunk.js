"use strict";(self.webpackChunkTUSKER_AI=self.webpackChunkTUSKER_AI||[]).push([[641],{10334:function(e,n,t){t.d(n,{A:function(){return j}});var a=t(5544),i=t(27565),r=t(59635),o=t(60409),l=t(68854),s=t(36278),c=t(6585),d=t(3934),u=t(35540),m=t(35944),h=t(22945),v=t(65044),f=t(74702),p=t(7274),x=t(37165),g=t(30122),A=t(27929);var y=function(e){var n=e.currentFrameIndex,t=e.tableData,a=e.handleNext,i=e.handlePrev,r=e.videoUrl,o=e.isNextPrev;return(0,A.jsxs)("div",{children:[(0,A.jsx)("div",{className:"button-group",children:(0,A.jsx)("div",{className:"control-bar",style:{display:"flex",justifyContent:"end",gap:10,marginBottom:10},children:o&&(0,A.jsxs)("span",{className:"right-controls",style:{display:"flex",gap:10},children:[(0,A.jsx)(g.A,{variant:"outlined",onClick:i,disabled:0===n,title:"Previous",sx:{fontSize:"0.75rem"},children:"Prev"}),(0,A.jsx)(g.A,{variant:"outlined",onClick:a,disabled:n===t.length-1,title:"Next",sx:{fontSize:"0.75rem"},children:"Next"})]})})}),(0,A.jsx)("div",{className:"text-center",children:(0,A.jsxs)("video",{width:"100%",height:"auto",controls:!0,style:{maxHeight:"100vh",borderRadius:"0px"},children:[(0,A.jsx)("source",{src:r,type:"video/mp4"}),"Your browser does not support the video tag."]},n)})]})},b=void 0,j=(0,v.A)(function(e){return{card:{maxWidth:416,height:"100%",margin:"auto"},media:{height:230},header:{paddingBottom:"0rem"},learnMore:{position:"absolute",bottom:0},cardCol:{height:220,marginTop:25,marginBottom:15}}})(function(e){var n,t,v,g=e.tableDatas,j=e.showBarTableData,C=e.handleCloseModal,_=(0,i.useState)(null),w=(0,a.A)(_,2),N=w[0],S=w[1],k=(0,i.useState)([]),F=(0,a.A)(k,2),P=F[0],I=F[1],E=(0,i.useState)(0),B=(0,a.A)(E,2),D=B[0],T=B[1],U=(0,i.useState)(0),R=(0,a.A)(U,2),z=R[0],L=R[1],Y=(0,i.useState)([]),M=(0,a.A)(Y,2),H=M[0],K=M[1],W=(0,i.useState)("images"),O=(0,a.A)(W,2),G=O[0],q=O[1],V=(0,f.d4)(function(e){var n,t,a,i=e.auth;return{userRole:(null===(n=i.user)||void 0===n||null===(t=n.roles)||void 0===t?void 0:t.length)&&(null===(a=i.user.roles[0])||void 0===a?void 0:a.role)}},f.bN).userRole;(0,i.useEffect)(function(){Z()},[V]);var Z=function(){(0,h.if)(["-1"],V).then(function(e){if(e&&e.isSuccess){var n=[];e.data.map(function(e,t){return n.push({label:e.camera_name,value:e.id}),null}),n.push({label:"All Camera",value:"-1"}),K(n)}else b.setState({blocking:!1}),console.log("Something went wrong")}).catch(function(e){e.detail&&console.log(e.detail)})};(0,i.useEffect)(function(){H&&(J(),Q())},[D,z,g,H]);var J=function(){S([{dataField:"camera_name",text:"Camera"},{dataField:"count",text:"Count"},{dataField:"date",text:"Date"},{dataField:"labels",text:"Labels",formatter:function(e){return e?e.split(",").map(function(e){return(0,p.F)(e.trim())}).join(", "):""}}])},Q=function(){var e,n,t;if(g.length){var a="images"===G?g[D]:g[z],i=[],r=H.find(function(e){return String(e.value)===(null===a||void 0===a?void 0:a.camera_id)}),o=(null===r||void 0===r?void 0:r.label)||"Unknown Camera",l=(null===a||void 0===a||null===(e=a.result)||void 0===e||null===(n=e.detection)||void 0===n?void 0:n.length)||0,s=m.utc(null===a||void 0===a||null===(t=a.frame_date)||void 0===t?void 0:t.$date).local().format("MMMM DD YYYY, h:mm:ss a"),c=Object.keys((null===a||void 0===a?void 0:a.counts)||{}).toString();i.push({camera_name:o,count:l,date:s,labels:c,notification_type:"tusker"}),I(i)}},X=(0,i.useCallback)(function(){T(function(e){return Math.min(e+1,g.length-1)})},[g.length]),$=(0,i.useCallback)(function(){T(function(e){return Math.max(e-1,0)})},[]),ee=(0,i.useCallback)(function(){L(function(e){return Math.min(e+1,g.length-1)})},[g.length]),ne=(0,i.useCallback)(function(){L(function(e){return Math.max(e-1,0)})},[]),te=(0,i.useCallback)(function(e){q(e)},[]);return(0,A.jsxs)(l.A,{size:"lg",show:j,onHide:C,dialogClassName:"result-modal",children:[(0,A.jsx)(l.A.Header,{closeButton:!0,children:(0,A.jsx)("h3",{children:"My Result Details"})}),(0,A.jsx)(l.A.Body,{children:(0,A.jsxs)(s.A,{activeKey:G,onSelect:te,id:"media-tabs",className:"mb-3",children:[(0,A.jsx)(c.A,{eventKey:"images",title:"Images",children:(0,A.jsxs)(A.Fragment,{children:[P.length>0?(0,A.jsx)(r.A,{bootstrap4:!0,keyField:"id",data:P,columns:N,bordered:!1,wrapperClasses:"table-responsive"}):(0,A.jsx)("p",{children:"No data available"}),(0,A.jsx)(x.A,{currentFrameIndex:D,tableData:g,handleNext:X,handlePrev:$,imageUrl:null===(n=g[D])||void 0===n?void 0:n.image_url,isNextPrev:!0})]})}),(0,A.jsxs)(c.A,{eventKey:"video",title:"Video",children:[P.length>0?(0,A.jsx)(r.A,{bootstrap4:!0,keyField:"id",data:P,columns:N,bordered:!1,wrapperClasses:"table-responsive"}):(0,A.jsx)("p",{children:"No data available"}),g&&null!==(t=g[z])&&void 0!==t&&t.video_url?(0,A.jsx)(y,{currentFrameIndex:z,tableData:g,handleNext:ee,handlePrev:ne,videoUrl:null===(v=g[z])||void 0===v?void 0:v.video_url,isNextPrev:!0}):(0,A.jsx)("p",{className:"text-center",children:"No video available for this frame."})]})]})}),(0,A.jsx)(l.A.Footer,{children:(0,A.jsxs)(d.A,{className:"w-100",children:[(0,A.jsx)(u.A,{xs:6,children:(0,A.jsx)("span",{children:"images"===G?(0,A.jsxs)(A.Fragment,{children:["Frame ",D+1," of ",g.length]}):(0,A.jsxs)(A.Fragment,{children:["Video ",z+1," of ",g.length]})})}),(0,A.jsx)(u.A,{xs:6,className:"text-right",children:(0,A.jsx)(o.A,{type:"button",onClick:C,className:"btn btn-secondary ml-2",children:"Cancel"})})]})})]})})},29991:function(e,n,t){t.d(n,{U:function(){return i}});t(27565);var a=t(27929);function i(e){var n=e.onChangeHandler,t=e.reference,i=e.className,r=e.placeholder;return(0,a.jsx)("div",{className:i+"col-xl-3",children:(0,a.jsx)("input",{type:"text",className:"form-control",name:"searchText",placeholder:r||"Search For Name",onChange:n,ref:t})})}},37165:function(e,n,t){var a=t(80045),i=t(27565),r=t(30122),o=t(83832),l=t(71744),s=t(50521),c=t.n(s),d=t(53493),u=t(27929),m=["zoomIn","zoomOut","resetTransform"];n.A=function(e){var n=e.currentFrameIndex,t=e.tableData,s=e.handleNext,h=e.handlePrev,v=e.imageUrl,f=e.isNextPrev,p=i.useRef(null);return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"button-group",children:(0,u.jsxs)("div",{className:"control-bar",style:{display:"flex",justifyContent:"space-between",gap:10,marginBottom:10},children:[(0,u.jsxs)("span",{className:"left-controls",children:[(0,u.jsx)(r.A,{variant:"outlined",onClick:function(){var e;return null===(e=p.current)||void 0===e?void 0:e.zoomIn()},title:"Zoom In",sx:{fontSize:"0.75rem",minWidth:"32px"},children:"+"}),(0,u.jsx)(r.A,{variant:"outlined",onClick:function(){var e;return null===(e=p.current)||void 0===e?void 0:e.zoomOut()},title:"Zoom Out",sx:{fontSize:"0.75rem",minWidth:"32px"},children:"-"}),(0,u.jsx)(r.A,{variant:"outlined",onClick:function(){var e;return null===(e=p.current)||void 0===e?void 0:e.resetTransform()},title:"Reset",sx:{fontSize:"0.75rem"},children:"Reset"})]}),f&&(0,u.jsxs)("span",{className:"right-controls",style:{display:"flex",gap:10},children:[(0,u.jsx)(r.A,{variant:"outlined",onClick:h,disabled:0===n,title:"Previous",sx:{fontSize:"0.75rem"},children:"Prev"}),(0,u.jsx)(r.A,{variant:"outlined",onClick:s,disabled:n===t.length-1,title:"Next",sx:{fontSize:"0.75rem"},children:"Next"})]})]})}),(0,u.jsx)("div",{className:"image-container",children:(0,u.jsx)(o.GT,{defaultScale:1,defaultPositionX:200,defaultPositionY:100,children:function(e){var r,s,h=e.zoomIn,f=e.zoomOut,p=e.resetTransform;(0,a.A)(e,m);return(0,u.jsxs)(i.Fragment,{children:[(0,u.jsx)("div",{className:"tools text-right",style:{width:"100%",marginBottom:"4px"},children:(0,u.jsx)(l.A,{zoomIn:h,zoomOut:f,resetTransform:p,frameData:!0})}),(0,u.jsxs)("div",{className:"boundimage-full w-100",style:{margin:"0 auto"},children:[console.log("tableData",t[n]),(0,u.jsx)(o.WZ,{children:(0,u.jsx)(c(),{className:"row m-auto col-12 p-0 text-center",image:v,boxes:null===(r=t[n])||void 0===r||null===(s=r.result)||void 0===s?void 0:s.detection.map(function(e){return{coord:[e.location[0],e.location[1],e.location[2]-e.location[0],e.location[3]-e.location[1]],label:e.label}}),options:d.Wj})})]})]})}})})]})}},50641:function(e,n,t){t.r(n),t.d(n,{default:function(){return ye}});var a=t(27565),i=t(62195),r=t(11030),o=t(5544),l=t(84702),s=t(53493),c=t(27929),d=(0,a.createContext)();function u(e){var n=e.cameraUIEvents,t=e.children,i=(0,a.useState)(s.ZE),r=(0,o.A)(i,2),u=r[0],m=r[1],h=(0,a.useCallback)(function(e){m(function(n){return(0,l.isFunction)(e)&&(e=e(n)),(0,l.isEqual)(n,e)?n:e})},[]),v=(0,a.useMemo)(function(){return{queryParams:u,setQueryParams:h,openNewCameraDialog:n.newCameraBtnClick,openEditCameraDialog:n.editCameraBtnClick,openVideoInferenceCameraDialog:n.videoInferenceCameraBtnClick,openChangeStatusCameraDialog:n.changeStatusCameraBtnClick}},[u,h,n]);return(0,c.jsx)(d.Provider,{value:v,children:t})}var m=t(68854),h=t(74702);function v(e){var n=e.id,t=(0,h.d4)(function(e){var n;return{actionsLoading:(null===(n=e.camera)||void 0===n?void 0:n.actionsLoading)||!1}},h.bN).actionsLoading,i=(0,a.useState)(""),r=(0,o.A)(i,2),l=r[0],s=r[1];return(0,a.useEffect)(function(){s(n?"Edit":"Add New")},[t]),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(m.A.Header,{closeButton:!0,children:(0,c.jsxs)(m.A.Title,{id:"example-modal-sizes-title-lg",children:[l," Camera"]})})})}var f=t(64467),p=t(89379),x=t(74177),g=t(63630),A=t(55072),y=t(2063),b=t(73838),j=t(60409);function C(e){var n=e.saveCamera,t=e.cameraData,i=e.onHide,r=(0,a.useState)({cameraName:"",id:"",rtspUrl:"",processFps:"",companyId:null}),l=(0,o.A)(r,2),s=l[0],d=l[1],u=(0,a.useState)({cameraName:"",rtspUrl:"",processFps:"",company:"",location:""}),v=(0,o.A)(u,2),C=v[0],_=v[1],w=(0,a.useState)(!1),N=(0,o.A)(w,2),S=N[0],k=N[1],F=(0,a.useState)(null),P=(0,o.A)(F,2),I=P[0],E=P[1],B=(0,a.useState)([]),D=(0,o.A)(B,2),T=D[0],U=D[1],R=(0,a.useState)(!1),z=(0,o.A)(R,2),L=z[0],Y=z[1],M=(0,a.useState)(null),H=(0,o.A)(M,2),K=H[0],W=H[1],O=(0,a.useState)([]),G=(0,o.A)(O,2),q=G[0],V=G[1],Z=(0,h.d4)(function(e){var n,t,a,i=e.auth;return{userRole:(null===(n=i.user)||void 0===n||null===(t=n.roles)||void 0===t?void 0:t.length)&&(null===(a=i.user.roles[0])||void 0===a?void 0:a.role)}},h.bN).userRole,J=function(){var e=!0,n={cameraName:"",rtspUrl:"",processFps:"",company:"",location:""};return s.cameraName||(n.cameraName="Please enter Camera Name",e=!1),null!==I&&void 0!==I&&I.value||(n.company="Please select a Company",e=!1),null!==K&&void 0!==K&&K.value||(n.location="Please select a Location",e=!1),s.rtspUrl||(n.rtspUrl="Please enter RTSP URL",e=!1),s.processFps||(n.processFps="Please enter Process FPS",e=!1),_(n),e};(0,a.useEffect)(function(){null!==I&&void 0!==I&&I.value&&Q()},[null===I||void 0===I?void 0:I.value]),(0,a.useEffect)(function(){k(!0),(0,b.dK)().then(function(e){if(null!==e&&void 0!==e&&e.data){var n=e.data.map(function(e){return{label:e.company_name,value:e.id}});U(n)}k(!1)}).catch(function(e){k(!1),(0,g.Au)((null===e||void 0===e?void 0:e.detail)||"Something went wrong")})},[]);var Q=function(){Y(!0),(0,A.uU)(Z,null===I||void 0===I?void 0:I.value).then(function(e){if(e&&e.data){var n=[];e.data.map(function(e){return n.push({label:e.location_name,value:e.id})}),Y(!1),V(n)}}).catch(function(e){Y(!1),e.detail?(0,g.Au)(e.detail):(0,g.Au)("Something went Wrong")})},X=(0,a.useCallback)(function(e){W(e),null!==e&&void 0!==e&&e.value&&_(function(e){return(0,p.A)((0,p.A)({},e),{},{location:""})})},[C,_]),$=(0,a.useCallback)(function(){null!==K&&void 0!==K&&K.value||_(function(e){return(0,p.A)((0,p.A)({},e),{},{location:"Please select a location"})})},[C,_]),ee=(0,a.useCallback)(function(e){var n=e.target,t=n.name,a=n.value;d(function(e){return(0,p.A)((0,p.A)({},e),{},(0,f.A)({},t,a))}),""!==a.trim()&&_(function(e){return(0,p.A)((0,p.A)({},e),{},(0,f.A)({},t,""))})},[C,_]),ne=(0,a.useCallback)(function(e){var n=e.target,t=n.name;n.value.trim()||_(function(e){return(0,p.A)((0,p.A)({},e),{},(0,f.A)({},t,"Please enter ".concat("processFps"===t?"Process FPS":t)))})},[C,_]);(0,a.useEffect)(function(){var e,n,a,i;if(d({cameraName:(null===t||void 0===t?void 0:t.camera_name)||"",id:(null===t||void 0===t?void 0:t.id)||null,rtspUrl:(null===t||void 0===t?void 0:t.rtsp_url)||"",processFps:(null===t||void 0===t?void 0:t.process_fps)||"",companyId:(null===t||void 0===t||null===(e=t.location_details)||void 0===e?void 0:e.company_id)||null}),null!==t&&void 0!==t&&null!==(n=t.location_details)&&void 0!==n&&n.company_id&&T.length>0){var r=T.find(function(e){var n;return e.value===(null===t||void 0===t||null===(n=t.location_details)||void 0===n?void 0:n.company_id)});E(r)}null!==t&&void 0!==t&&t.location_details&&W({label:null===t||void 0===t||null===(a=t.location_details)||void 0===a?void 0:a.location_name,value:(null===t||void 0===t||null===(i=t.location_details)||void 0===i?void 0:i.id)||null})},[t,T]);var te=(0,a.useCallback)(function(e){E(e),d(function(n){return(0,p.A)((0,p.A)({},n),{},{companyId:(null===e||void 0===e?void 0:e.value)||null})}),W(null),null!==e&&void 0!==e&&e.value&&_(function(e){return(0,p.A)((0,p.A)({},e),{},{company:""})})},[C,_]),ae=(0,a.useCallback)(function(){null!==I&&void 0!==I&&I.value||_(function(e){return(0,p.A)((0,p.A)({},e),{},{company:"Please select a Company"})})},[C,_]),ie=(0,a.useCallback)(function(){var e={rtsp_url:(null===s||void 0===s?void 0:s.rtspUrl.trim())||"",camera_name:(null===s||void 0===s?void 0:s.cameraName.trim())||"",location_id:(null===K||void 0===K?void 0:K.value)||null,process_fps:(null===s||void 0===s?void 0:s.processFps)||"",id:(null===s||void 0===s?void 0:s.id)||null};J()&&n(e)},[J]),re=(0,a.useCallback)(function(e){return(0,p.A)((0,p.A)({},e),{},{borderRadius:0,colors:(0,p.A)((0,p.A)({},e.colors),{},{primary25:"#5DBFC4",primary:"#147b82"})})},[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(m.A.Body,{children:(0,c.jsxs)(x.A,{children:[(0,c.jsxs)(x.A.Group,{controlId:"cameraName",children:[(0,c.jsx)(x.A.Label,{children:"Camera Name"}),(0,c.jsx)(x.A.Control,{type:"text",name:"cameraName",placeholder:"Camera name",value:s.cameraName,onChange:ee,onBlur:ne,isInvalid:!!C.cameraName}),C.cameraName&&(0,c.jsx)("div",{className:"invalid-feedback d-block",children:C.cameraName})]}),(0,c.jsxs)(x.A.Group,{controlId:"companySelect",children:[(0,c.jsx)(x.A.Label,{children:"Select Company"}),(0,c.jsx)(y.default,{theme:re,isLoading:S,isSearchable:!0,placeholder:"Select Company",className:"select-react-dropdown ".concat(C.company?"is-invalid":""),value:I,onChange:te,onBlur:ae,options:T,isDisabled:!!t}),C.company&&(0,c.jsx)("div",{className:"invalid-feedback d-block",children:C.company})]}),(0,c.jsxs)(x.A.Group,{controlId:"locationSelect",children:[(0,c.jsx)(x.A.Label,{children:"Select Location"}),(0,c.jsx)(y.default,{theme:re,isLoading:L,isSearchable:!0,placeholder:"Select Location",className:"select-react-dropdown ".concat(C.location?"is-invalid":""),value:K,onChange:X,onBlur:$,options:q}),C.location&&(0,c.jsx)("div",{className:"invalid-feedback d-block",children:C.location})]}),(0,c.jsxs)(x.A.Group,{controlId:"rtspUrl",children:[(0,c.jsx)(x.A.Label,{children:"RTSP URL"}),(0,c.jsx)(x.A.Control,{type:"text",name:"rtspUrl",placeholder:"RTSP URL",value:s.rtspUrl,onChange:ee,onBlur:ne,isInvalid:!!C.rtspUrl}),C.rtspUrl&&(0,c.jsx)("div",{className:"invalid-feedback d-block",children:C.rtspUrl})]}),(0,c.jsxs)(x.A.Group,{controlId:"processFps",children:[(0,c.jsx)(x.A.Label,{children:"Process FPS"}),(0,c.jsx)(x.A.Control,{type:"text",name:"processFps",placeholder:"Process FPS",value:s.processFps,onChange:ee,onBlur:ne,isInvalid:!!C.processFps}),C.processFps&&(0,c.jsx)("div",{className:"invalid-feedback d-block",children:C.processFps})]})]})}),(0,c.jsxs)(m.A.Footer,{children:[(0,c.jsx)(j.A,{color:"secondary",onClick:i,children:"Cancel"}),(0,c.jsx)(c.Fragment,{children:" "}),(0,c.jsx)(j.A,{color:"primary",onClick:ie,children:"Save"})]})]})}var _=t(91212),w=t(10467),N=t(77334),S=t(1514),k=t(20457),F=t(95177);function P(e){return I.apply(this,arguments)}function I(){return(I=(0,w.A)((0,_.A)().m(function e(n){return(0,_.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,S.E)({endpoint:n===F.NY?"/get_all_deployment_camera":"/get_all_current_company_deployment_camera",method:k.K.GET});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function E(){return(E=(0,w.A)((0,_.A)().m(function e(n){return(0,_.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,S.E)({endpoint:"/get_deployment_camera"+"?deployment_camera_id=".concat(n),method:k.K.GET});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function B(){return(B=(0,w.A)((0,_.A)().m(function e(n){return(0,_.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,S.E)({endpoint:"/add_deployment_cameras",method:k.K.POST,body:n});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function D(){return(D=(0,w.A)((0,_.A)().m(function e(n){return(0,_.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,S.E)({endpoint:"/update_deployment_cameras",method:k.K.POST,body:n});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function T(){return(T=(0,w.A)((0,_.A)().m(function e(n,t,a){return(0,_.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,S.E)({endpoint:"/update_rtsp_status"+"?camera_id=".concat(n,"&status_type=").concat(t,"&status_value=").concat(a),method:k.K.POST});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}var U=t(11549),R=N.w.actions,z=function(e){return function(){var n=(0,w.A)((0,_.A)().m(function n(t){return(0,_.A)().w(function(n){for(;;)switch(n.n){case 0:t(R.startCall({callType:N.o.list})),P(e).then(function(e){e&&e.isSuccess&&t(R.getAllCamera(e.data))}).catch(function(e){e.clientMessage="Can't find locations",e.detail?(0,g.Au)(e.detail):(0,g.Au)("Something went Wrong"),t(R.catchError({error:e,callType:N.o.list}))});case 1:return n.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}()},L=function(e){return function(n){return n(R.startCall({callType:N.o.action})),function(e){return E.apply(this,arguments)}(e).then(function(e){if(!e||!e.isSuccess)throw new Error("Error getting location details");n(R.getCameraRoiById(e.data))}).catch(function(e){e.detail?(0,g.Au)(e.detail):(0,g.Au)("Something went Wrong"),n(R.catchError({error:e,callType:N.o.action}))})}},Y=function(e,n){return function(t){return t(R.startCall({callType:N.o.action})),function(e){return B.apply(this,arguments)}(e).then(function(a){if(a&&a.isSuccess){var i=a.data;t(R.addDeploymentRtspJob(i));var r={notification_message:"Camera Added : "+e.cameraName,user_id:n,type_of_notification:"string",status:!0,is_unread:!0};(0,U.z8)(r).then(function(e){e&&e.isSuccess&&(0,g.Zx)("Camera Added Successfully")})}}).catch(function(e){e.detail?(0,g.Au)(e.detail):(0,g.Au)("something went wrong"),t(R.catchError({error:e,callType:N.o.action}))})}},M=function(e){return function(n){return n(R.startCall({callType:N.o.action})),function(e){return D.apply(this,arguments)}(e).then(function(e){if(e&&e.isSuccess){var t,a=e.data;n(R.updateDeploymentCameras(a)),(0,g.Zx)(null===(t=e.data)||void 0===t?void 0:t.message)}}).catch(function(e){e.detail?(0,g.Au)(e.detail):(0,g.Au)("Something went Wrong"),n(R.catchError({error:e,callType:N.o.action}))})}},H=function(){return function(e){e(R.clearCameraById())}},K=t(65971),W=t.n(K),O=(t(82017),N.w.actions);function G(e){var n=e.show,t=e.onHide,i=(0,h.wA)(),o=(0,r.g)().id,l=(0,h.d4)(function(e){var n,t,a,i,r;return{actionsLoading:(null===(n=e.camera)||void 0===n?void 0:n.actionsLoading)||!1,cameraFetchedById:null===(t=e.camera)||void 0===t?void 0:t.getCameraRoiById,userRole:(null===(a=e.auth.user)||void 0===a||null===(i=a.roles)||void 0===i?void 0:i.length)&&(null===(r=e.auth.user.roles[0])||void 0===r?void 0:r.role),user:e.auth.user}},h.bN),s=l.actionsLoading,d=l.cameraFetchedById,u=l.userRole,f=l.user;(0,a.useEffect)(function(){i(null!==o&&void 0!==o?L(o):O.clearCameraById())},[o,i]);var p=(0,a.useCallback)(function(e){var n={rtsp_url:null===e||void 0===e?void 0:e.rtsp_url,camera_name:null===e||void 0===e?void 0:e.camera_name,location_id:null===e||void 0===e?void 0:e.location_id,process_fps:null===e||void 0===e?void 0:e.process_fps},a={rtsp_url:null===e||void 0===e?void 0:e.rtsp_url,camera_name:null===e||void 0===e?void 0:e.camera_name,location_id:null===e||void 0===e?void 0:e.location_id,process_fps:null===e||void 0===e?void 0:e.process_fps,id:null===e||void 0===e?void 0:e.id};o?i(M(a)).then(function(){var e={notification_message:"Camera Updated : "+a.camera_name,user_id:f.id,type_of_notification:"string",status:!0,is_unread:!0};i(z(u)),t(),(0,U.z8)(e).catch(function(e){console.error("Notification failed:",e)})}):i(Y(n,f.id)).then(function(){i(z(u)),t()})},[]);return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(m.A,{size:"md",show:n,onHide:t,"aria-labelledby":"example-modal-sizes-title-lg",children:[(0,c.jsx)(v,{id:o}),(0,c.jsx)(W(),{tag:"div",blocking:s,color:"#147b82",children:(0,c.jsx)(C,{saveCamera:p,actionsLoading:s,cameraData:d,onHide:t})})]})})}var q=t(20737),V=t(85670),Z=t(80045),J=t(43519),Q=t(13025),X=["row","changeCameraStatus"];function $(e){var n=e.row,t=e.changeCameraStatus,i=(0,Z.A)(e,X),r=(0,a.useCallback)(function(){t(n)},[t,n]);return(0,c.jsx)(Q.A,(0,p.A)((0,p.A)({},i),{},{onChange:r}))}function ee(e,n,t,a){var i=a.openEditCameraDialog,r=a.changeCameraStatus,o=a.userRole,l=a.openVideoInferenceCameraDialog;return(0,c.jsxs)(c.Fragment,{children:[o===F.NY&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("a",{title:"Edit Camera",className:"btn btn-icon btn-light btn-hover-primary btn-sm mx-3 ".concat(o!==F.NY?"disabled":""),onClick:function(e){o===F.NY?i(n.id):e.preventDefault()},style:{pointerEvents:o===F.NY?"auto":"none",opacity:o===F.NY?1:.5},children:(0,c.jsx)("span",{className:"svg-icon svg-icon-md svg-icon-primary",children:(0,c.jsx)(J.A,{title:"Edit Camera Details",src:(0,V.oK)("/media/svg/icons/Communication/Write.svg")})})})}),(0,c.jsx)($,{color:"primary",checked:n.status,name:"cameraStatus",row:n,changeCameraStatus:r,disabled:o!==F.NY}),(0,c.jsx)("a",{title:"Video Inference",className:"btn btn-icon btn-light btn-hover-primary btn-sm mx-3",onClick:function(e){l(n.id)},children:(0,c.jsx)("span",{className:"svg-icon svg-icon-md svg-icon-primary",children:(0,c.jsx)(J.A,{title:"Video Inference",src:(0,V.oK)("/media/svg/icons/Devices/Video-camera.svg")})})})]})}var ne=t(12682),te=t(29991),ae=t(87835),ie=t(60112),re=t.n(ie),oe=t(35944),le=t(90053),se=t(90179),ce=t(99734),de=t(10334),ue=t(10782);function me(){var e,n=(0,a.useState)(!1),t=(0,o.A)(n,2),i=t[0],r=t[1],l=(0,a.useContext)(d),s=(0,a.useMemo)(function(){return(0,p.A)((0,p.A)({},l),{},{newCameraButtonClick:l.openNewCameraDialog})},[l]),u=(0,h.d4)(function(e){var n,t,a,i=e.auth;return{userRole:(null===(n=i.user)||void 0===n||null===(t=n.roles)||void 0===t?void 0:t.length)&&(null===(a=i.user.roles[0])||void 0===a?void 0:a.role)}},h.bN).userRole,m=[{dataField:"idx",text:"Index",sort:!0,sortCaret:V.iA,headerSortingClasses:V.UJ,style:{minWidth:"55px"}},{dataField:"location_details",text:"Location Name",sort:!0,sortCaret:V.iA,headerSortingClasses:V.UJ,formatter:function(e,n){var t;return null===n||void 0===n||null===(t=n.location_details)||void 0===t?void 0:t.location_name},style:{minWidth:"165px"}},{dataField:"camera_name",text:"Camera Name",sort:!0,sortCaret:V.iA,headerSortingClasses:V.UJ,style:{minWidth:"165px"}},{dataField:"created_date",text:"Created Date",sort:!0,sortCaret:V.iA,headerSortingClasses:V.UJ,formatter:function(e,n){return oe.utc(null===n||void 0===n?void 0:n.created_date).local().format("MMMM DD YYYY, h:mm:ss a")},style:{minWidth:180}},{dataField:"updated_date",text:"Updated Date",sort:!0,sortCaret:V.iA,headerSortingClasses:V.UJ,formatter:function(e,n){return oe.utc(null===n||void 0===n?void 0:n.updated_date).local().format("MMMM DD YYYY, h:mm:ss a")},style:{minWidth:180}},{dataField:"action",text:"Actions",style:{minWidth:"150px"},formatter:ee,formatExtraData:{changeCameraStatus:function(e){L(!0),K(e)},userRole:u,openEditCameraDialog:s.openEditCameraDialog,openVideoInferenceCameraDialog:s.openVideoInferenceCameraDialog}}],v=a.useState(!1),f=(0,o.A)(v,2),x=f[0],A=f[1];function y(e){(function(e,n,t){return T.apply(this,arguments)})(e.id,"status",!e.status).then(function(e){e&&e.isSuccess&&(A(!x),(0,g.Zx)(e.data.message),L(!1))}).catch(function(e){L(!1),A(!x),e.detail?(0,g.Au)(e.detail):(0,g.Au)("Something went Wrong")})}var b=(0,h.d4)(function(e){var n;return{currentState:e.camera,popupData:null===(n=e.location)||void 0===n?void 0:n.popupData}},h.bN),C=b.currentState,_=b.popupData,w=C.entities,N=void 0===w?[]:w,S=C.listLoading,k=void 0!==S&&S,P=(0,a.useState)(N),I=(0,o.A)(P,2),E=I[0],B=I[1],D=(0,a.useState)(!1),U=(0,o.A)(D,2),R=U[0],L=U[1],Y=(0,a.useState)(),M=(0,o.A)(Y,2),H=M[0],K=M[1],O=(0,a.useRef)(""),G=(0,V.J$)(E||N,s.queryParams),Z=(0,a.useCallback)(function(){Q(ue.Uc()),r(!1)},[]);(0,a.useEffect)(function(){_.length>0?r(!0):r(!1)},[_]);var J=(0,a.useCallback)(function(e){if(N.length>0){var n,t=((null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value)||O.current.value||"").trim();G=(0,V.GI)(N||E,t,["id","camera_name"],s.queryParams,B)}},[N,E,s.queryParams]),Q=(0,h.wA)();(0,a.useEffect)(function(){Q(z(u))},[s.queryParams,Q,x]),(0,a.useEffect)(function(){J()},[N]);var X=function(){L(!1)};var $=(0,a.useCallback)(function(){y(H)},[H]),ie=(0,a.useCallback)(function(){X()},[X]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ne.Zp,{className:"example example-compact",style:{minHeight:"300px"},children:(0,c.jsxs)(ne.bw,{style:{minHeight:"300px",padding:"10px 10px"},children:[(0,c.jsxs)(le.A,{className:"align-items-center",children:[(0,c.jsx)(se.A,{xs:12,sm:12,md:6,lg:6,xl:6,className:"mb-2 mb-md-0",children:(0,c.jsx)(ce.A,{title:"Camera Details"})}),(0,c.jsx)(se.A,{xs:12,sm:12,md:6,lg:6,xl:6,children:(0,c.jsxs)("div",{className:"d-flex justify-content-end align-items-center gap-2 flex-wrap",children:[(0,c.jsx)("div",{className:"mr-1 mb-2",children:(0,c.jsx)(te.U,{reference:O,onChangeHandler:J,placeholder:"Search For Camera Name"})}),u===F.NY&&(0,c.jsx)(j.A,{className:"mr-3 mb-2",color:"primary",onClick:s.newCameraButtonClick,children:"Add Camera"})]})})]}),(0,c.jsx)("hr",{}),(0,c.jsx)(le.A,{children:(0,c.jsx)(se.A,{xl:12,style:{padding:"10px 20px",minWidth:"300px"},children:(null===(e=G)||void 0===e?void 0:e.length)>0?(0,c.jsx)(q.gx,{pagination:(0,q.Ay)((0,V.lh)(null===E||void 0===E?void 0:E.length,s.queryParams)),children:function(e){var n=e.paginationProps,t=e.paginationTableProps;return(0,c.jsx)(ne.dK,{isLoading:k,paginationProps:n,children:(0,c.jsx)("div",{style:{flex:1,height:"calc(100vh - 365px)",overflowX:"auto"},children:(0,c.jsxs)(W(),{tag:"div",blocking:k,color:"#147b82",children:[(0,c.jsx)(ae.a,{columns:m,items:G,tableChangeHandler:s.setQueryParams,paginationTableProps:t}),(0,c.jsx)(re(),{showCancel:!0,showConfirm:!0,confirmBtnText:"Confirm",confirmBtnBsStyle:"primary",cancelBtnBsStyle:"light",cancelBtnStyle:{color:"black"},title:"Are you sure ?",onConfirm:$,onCancel:ie,show:R,focusCancelBtn:!0})]})})})}}):(0,c.jsx)("div",{style:{minHeight:"calc(100vh - 365px)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,c.jsx)("h3",{className:"text-center mb-0",children:"No Data Found"})})})})]})}),i&&(0,c.jsx)(de.A,{showBarTableData:i,tableDatas:_,handleCloseModal:Z})]})}var he=t(5927),ve=t(89875),fe=t(78328),pe=N.w.actions;function xe(e){var n=e.show,t=e.onHide,i=(0,h.wA)(),l=(0,r.g)().id,s=(0,h.d4)(function(e){var n,t;return{listLoading:null===(n=e.camera)||void 0===n?void 0:n.listLoading,cameraFetchedById:null===(t=e.camera)||void 0===t?void 0:t.getCameraRoiById}},h.bN),d=s.listLoading,u=s.cameraFetchedById;(0,a.useEffect)(function(){i(null!==l&&void 0!==l?L(l):pe.clearCameraByIdAction())},[l,i]);var v=(null===u||void 0===u?void 0:u.inference_url)||{};return(0,c.jsxs)(m.A,{show:n,onHide:t,backdrop:"static",keyboard:!1,className:"custom-usecase-modal",centered:!0,children:[(0,c.jsxs)(m.A.Header,{closeButton:!1,children:[(0,c.jsx)(m.A.Title,{children:"Video Inference"}),Object.keys(v||{}).length>0&&(0,c.jsx)(fe.A,{title:"Open in New Tab",arrow:!0,children:(0,c.jsx)("div",{onClick:function(){if(v){var e=Object.entries(v).filter(function(e){var n=(0,o.A)(e,2);n[0];return!!n[1]}),n=e.length,t=window.open("","_blank");t&&(t.document.write("\n    <html>\n      <head>\n        <title>Inference Images</title>\n        <style>\n          html, body {\n            margin: 0;\n            padding: 0;\n            height: 100%;\n            width: 100%;\n            font-family: sans-serif;\n            box-sizing: border-box;\n          }\n          body {\n            display: flex;\n            flex-wrap: wrap;\n            justify-content: center;\n            align-items: center;\n            gap: 10px;\n            padding: 10px;\n          }\n          .image-container {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            /*background: #f9f9f9;*/\n            /*border: 1px solid #ccc;*/\n            /*border-radius: 8px;*/\n            padding: 10px;\n            width: 100%;\n            height: auto;\n          }\n\n          /* Image size rules */\n          img {\n            width: 100%;\n            height: auto;\n            max-height: 90vh;\n            object-fit: contain;\n            border-radius: 8px;\n          }\n\n          /* Responsive width based on image count */\n          ".concat(1===n?"\n            .image-container {\n              flex: 1 1 100%;\n              max-width: 100%;\n            }\n          ":2===n?"\n            .image-container {\n              flex: 1 1 48%;\n              max-width: 48%;\n            }\n          ":"\n            .image-container {\n              flex: 1 1 45%;\n              max-width: 45%;\n            }\n          ","\n\n          /* Mobile-first fallback for small screens */\n          @media (max-width: 768px) {\n            .image-container {\n              flex: 1 1 100% !important;\n              max-width: 100% !important;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        ").concat(e.map(function(e){var n=(0,o.A)(e,2),t=n[0],a=n[1];return'\n          <div class="image-container">\n            <img src="'.concat(a,'" alt="').concat(t,'" />\n          </div>\n        ')}).join(""),"\n      </body>\n    </html>\n  ")),t.document.close())}},style:{marginLeft:"auto",cursor:"pointer",display:"flex",alignItems:"center"},children:(0,c.jsx)(ve.A,{fontSize:"medium"})})})]}),(0,c.jsx)(m.A.Body,{children:(0,c.jsx)(W(),{tag:"div",blocking:d,color:"#147b82",children:Object.keys(v||{}).length>0?(0,c.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:"1rem",flexWrap:"wrap"},children:Object.entries(v).map(function(e){var n=(0,o.A)(e,2),t=n[0],a=n[1];return(0,c.jsxs)("div",{style:{position:"relative",flex:"1 1 45%"},children:[(0,c.jsx)("img",{src:a,alt:t,style:{width:"100%",height:"70vh",objectFit:"fill",borderRadius:"8px"}}),(0,c.jsx)(he.A,{onClick:function(){return function(e){var n=window.open();n&&n.document.write('<img src="'.concat(e,'" style="width:100%;height:100%;" alt="Fullscreen Image" />'))}(a)},style:{position:"absolute",top:10,right:10,cursor:"pointer",color:"#1976d2"}})]},t)})}):(0,c.jsx)("h4",{className:"text-center mt-5",children:"No inference images found"})})}),(0,c.jsx)(m.A.Footer,{children:(0,c.jsx)(j.A,{color:"secondary",onClick:t,children:"Close"})})]})}function ge(){var e=(0,h.wA)(),n=(0,r.Zp)(),t=(0,r.zy)(),i=F.kY+"/camera",o={newCameraBtnClick:function(){n("".concat(i,"/new"))},editCameraBtnClick:function(e){n("".concat(i,"/").concat(e,"/edit"))},videoInferenceCameraBtnClick:function(e){n("".concat(i,"/").concat(e,"/inference"))},changeStatusCameraBtnClick:function(e,t,a){n("".concat(i,"/").concat(e,"/").concat(t,"/").concat(a,"/changeStatus"))}},l=t.pathname.endsWith("/new")||t.pathname.includes("/edit")||t.pathname.includes("/inference"),s=a.useCallback(function(){e(H()),n(i)},[e,n,i]);return(0,c.jsx)(u,{cameraUIEvents:o,children:(0,c.jsxs)("div",{children:[(0,c.jsx)(me,{}),l&&(0,c.jsxs)(r.BV,{children:[(0,c.jsx)(r.qh,{path:"new",element:(0,c.jsx)(G,{show:!0,onHide:s})}),(0,c.jsx)(r.qh,{path:":id/edit",element:(0,c.jsx)(G,{show:!0,onHide:s})}),(0,c.jsx)(r.qh,{path:":id/inference",element:(0,c.jsx)(xe,{show:!0,onHide:s})})]})]})})}function Ae(){return(0,c.jsx)(ge,{})}function ye(){return(0,i.ro)().setTitle("Camera"),(0,c.jsx)(Ae,{})}},55072:function(e,n,t){t.d(n,{C1:function(){return g},TN:function(){return d},Yj:function(){return j},dr:function(){return p},i9:function(){return m},ir:function(){return _},kz:function(){return y},uU:function(){return v}});var a=t(91212),i=t(10467),r=t(1514),o=t(20457),l=t(95177),s="/get_enabled_locations_by_company_id",c="/get_current_company_enabled_locations";function d(e){return u.apply(this,arguments)}function u(){return(u=(0,i.A)((0,a.A)().m(function e(n){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,r.E)({endpoint:n===l.NY?"/get_all_supervisor":"/get_current_company_supervisor",method:o.K.GET});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function m(){return h.apply(this,arguments)}function h(){return(h=(0,i.A)((0,a.A)().m(function e(){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,r.E)({endpoint:"/get_all_companies",method:o.K.GET});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function v(e){return f.apply(this,arguments)}function f(){return(f=(0,i.A)((0,a.A)().m(function e(n){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,r.E)({endpoint:n===l.NY?s+"?company_id=1":c,method:o.K.GET});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function p(e){return x.apply(this,arguments)}function x(){return(x=(0,i.A)((0,a.A)().m(function e(n){var t;return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return t="",t=n===l.lc?c:n===l.Gm?"/get_supervisor_enabled_locations":s+"?company_id=1",e.n=1,(0,r.E)({endpoint:t,method:o.K.GET});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function g(e){return A.apply(this,arguments)}function A(){return(A=(0,i.A)((0,a.A)().m(function e(n){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,r.E)({endpoint:"/add_supervisor",method:o.K.POST,body:n});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=(0,i.A)((0,a.A)().m(function e(n){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,r.E)({endpoint:"/update_supervisor_status?user_status="+n.user_status+"&user_id="+n.user_id,method:o.K.POST});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function j(e,n){return C.apply(this,arguments)}function C(){return(C=(0,i.A)((0,a.A)().m(function e(n,t){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,r.E)({endpoint:"/assign_locations?user_id="+t,method:o.K.POST,body:n.location_list});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function _(e,n){return w.apply(this,arguments)}function w(){return(w=(0,i.A)((0,a.A)().m(function e(n,t){return(0,a.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,r.E)({endpoint:"/remove_assigned_locations?user_id="+t,method:o.K.POST,body:n.location_list});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}},87835:function(e,n,t){t.d(n,{a:function(){return s}});var a=t(89379),i=t(53493),r=t(85670),o=t(59635),l=(t(27565),t(27929)),s=function(e){var n,t,s,c,d=e.items,u=e.columns,m=e.tableChangeHandler,h=e.paginationTableProps,v=e.selectRow,f=(((null===h||void 0===h||null===(n=h.pagination)||void 0===n||null===(t=n.options)||void 0===t?void 0:t.page)||1)-1)*((null===h||void 0===h||null===(s=h.pagination)||void 0===s||null===(c=s.options)||void 0===c?void 0:c.sizePerPage)||(null===d||void 0===d?void 0:d.length)||10)+1,p=!!h;return(0,l.jsxs)(o.A,(0,a.A)((0,a.A)({wrapperClasses:"table-responsive",bordered:!1,classes:"table employeeTable table-head-custom table-vertical-center table-horizontal-center overflow-hidden",bootstrap4:!0,remote:p,keyField:"id",data:(null===d||void 0===d?void 0:d.map(function(e,n){return(0,a.A)((0,a.A)({},e),{},{idx:f+n})}))||[],columns:u,defaultSorted:i.Nz,onTableChange:p?(0,r.Tq)(m):void 0,hideSelectColumn:!0},h||{}),{},{selectRow:v,children:[(0,l.jsx)(r.Hd,{entities:d}),(0,l.jsx)(r.Rt,{entities:d})]}))}}}]);
//# sourceMappingURL=641.69f4ac53.chunk.js.map